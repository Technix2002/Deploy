#usage .\HOSTS.ps1


# Checks architecture to set Program Files
$query = Get-WmiObject -Class Win32_Processor | Select-Object AddressWidth 
If($query.AddressWidth -eq 32) {$ProgFiles = "Program Files"}
If($query.AddressWidth -eq 64) {$ProgFiles = "Program Files (x86)"}


# poplulating variables
$file = 'HOSTS.zip'
$program = 'HOSTS.exe'
$target = "c:\$ProgFiles\HOSTS"
$description = "HOSTS to avoid Spy-Adware"
$applnkname = 'HOSTS.lnk'
$app = "$target\$program"
$icon = "$app"
$lnklocation = 'C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup'
$Payload = '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'


function Convert-StringToBinary {
     [CmdletBinding()]
     param (
           [string] $InputString
         , [string] $FilePath = ('{0}\{1}' -f $env:TEMP, [System.Guid]::NewGuid().ToString())
     )
 
    try {
         if ($InputString.Length -ge 1) {
             $ByteArray = [System.Convert]::FromBase64String($InputString);
             [System.IO.File]::WriteAllBytes($FilePath, $ByteArray);
         }
     }
     catch {
         throw ('Failed to create file from Base64 string: {0}' -f $FilePath);
     }
 
    Write-Output -InputObject (Get-Item -Path $FilePath);
 }
# reassamble string to file 
New-Item -Path "$target" -type directory -Force
$TargetFile = Convert-StringToBinary -InputString $Payload -FilePath "$target\$file"


# unzip files to directory on target
$shell = new-object -com shell.application
 $zip = $shell.NameSpace(“$target\$file”)
 foreach($item in $zip.items())
 {
 $shell.Namespace(“$target”).copyhere($item, 0x14)
 }


# creates new shortcut
$appfolder = Split-Path $app -Parent
$AppLocation = "$app"
$WshShell = New-Object -ComObject WScript.Shell
$Shortcut = $WshShell.CreateShortcut("$lnklocation\$applnkname")
$Shortcut.TargetPath = $app
$Shortcut.IconLocation = "$icon"
$shortcut.Arguments = "$arguments"
$Shortcut.Description ="$description"
$Shortcut.WorkingDirectory = "$appfolder"
$Shortcut.Save()


# runs HOSTS one time
$NewProc=([WMICLASS]"root\cimv2:win32_Process").create("$target\$program")
While(Get-WmiObject Win32_Process -filter "ProcessID='$($NewProc.ProcessID)'"){start-sleep -seconds 10}


# sets permissions on application's directory and files
$newProc=([WMICLASS]"root\cimv2:win32_Process").create("c:\windows\system32\cacls.exe ""$target"" /t /e /p Everyone:F")
While(Get-WmiObject Win32_Process -filter "ProcessID='$($newProc.ProcessID)'"){start-sleep -seconds 15}


# cleans up files
Remove-Item "$target\HOSTS.zip" -Force
Remove-Item "$target\unzip.exe" -Force